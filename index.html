<!DOCTYPE html>
<html>
<head>
    <title>å¯»å®è·¯çº¿å›¾</title>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: "Microsoft YaHei", sans-serif;
            text-align: center;
            background: #f0f8ff;
        }
        h1 {
            color: #2c3e50;
            margin: 20px 0;
        }
        #map-container {
            width: 800px;
            height: 550px;
            margin: 0 auto;
            position: relative;
            background: url('https://img.freepik.com/free-vector/blank-green-landscape-background_1308-252.jpg') center/cover;
            border: 3px solid #3498db;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
        }
        .character {
            width: 40px;
            height: 40px;
            background: url('https://cdn-icons-png.flaticon.com/512/5231/5231019.png') center/cover;
            position: absolute;
            transition: all 1s linear;
            z-index: 10;
        }
        .treasure {
            width: 60px;
            height: 60px;
            background: url('https://cdn-icons-png.flaticon.com/512/2037/2037739.png') center/cover;
            position: absolute;
            display: none;
            z-index: 5;
        }
        .controls {
            margin: 20px auto;
            padding: 15px;
            background: white;
            border-radius: 10px;
            width: 600px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        button {
            padding: 12px 25px;
            margin: 0 10px;
            background: #2ecc71;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
        }
        button:hover {
            background: #27ae60;
            transform: scale(1.05);
        }
        #result {
            min-height: 80px;
            padding: 15px;
            font-size: 18px;
            color: #34495e;
            margin: 15px auto;
            width: 80%;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .path-line {
            position: absolute;
            background: red;
            height: 4px;
            transform-origin: left center;
            z-index: 1;
        }
    </style>
</head>
<body>
    <h1>ğŸ´â€â˜ ï¸ å¯»å®æ¢é™©å®¶</h1>
    
    <div class="controls">
        <button onclick="startListening()">ğŸ¤ è¯­éŸ³è¾“å…¥è·¯çº¿</button>
        <button onclick="startJourney()">ğŸš¶ å¼€å§‹å¯»å®</button>
        <button onclick="checkPosition()">ğŸ” æˆ‘åˆ°è¾¾äº†</button>
    </div>
    
    <div id="map-container">
        <div id="char" class="character"></div>
        <div id="treasure" class="treasure"></div>
        <!-- è·¯å¾„çº¿å°†åŠ¨æ€ç”Ÿæˆ -->
    </div>
    
    <div id="result">ç­‰å¾…æ‚¨çš„æŒ‡ä»¤...</div>

    <script>
        // åˆå§‹åæ ‡ï¼ˆèµ·ç‚¹ï¼‰
        const startPos = { x: 100, y: 450 };
        const treasurePos = { x: 650, y: 200 };
        let currentPos = {...startPos};
        let pathData = null;
        let pathLines = [];
        
        // åˆå§‹åŒ–åœ°å›¾
        function initMap() {
            const char = document.getElementById('char');
            const treasure = document.getElementById('treasure');
            
            char.style.left = startPos.x + 'px';
            char.style.top = startPos.y + 'px';
            
            treasure.style.left = treasurePos.x + 'px';
            treasure.style.top = treasurePos.y + 'px';
        }
        
        // è¯­éŸ³è¾“å…¥åŠŸèƒ½
        function startListening() {
            document.getElementById('result').innerHTML = "æ­£åœ¨å¬...è¯·è¯´ï¼š'ä»èµ·ç‚¹å‘åŒ—èµ°200ç±³ï¼Œå†å‘ä¸œèµ°300ç±³'";
            
            // æ¨¡æ‹Ÿè¯­éŸ³è¯†åˆ«ç»“æœï¼ˆå®é™…ä½¿ç”¨æ—¶æ›¿æ¢ä¸ºçœŸå®APIï¼‰
            setTimeout(() => {
                simulateVoiceResponse();
            }, 2000);
        }
        
        // æ¨¡æ‹Ÿè¯­éŸ³è¯†åˆ«ç»“æœ
        function simulateVoiceResponse() {
            pathData = {
                start: "èµ·ç‚¹",
                steps: [
                    {direction: "north", distance: 200},
                    {direction: "east", distance: 300}
                ]
            };
            
            document.getElementById('result').innerHTML = 
                "<b>è·¯çº¿å·²æ¥æ”¶ï¼š</b><br>1. å‘åŒ—èµ°200ç±³<br>2. å‘ä¸œèµ°300ç±³";
        }
        
        // å¼€å§‹å¯»å®åŠ¨ç”»
        function startJourney() {
            if (!pathData) {
                document.getElementById('result').innerHTML = "âŒ è¯·å…ˆè¾“å…¥è·¯çº¿ï¼";
                return;
            }
            
            const char = document.getElementById('char');
            
            // æ¸…é™¤æ—§è·¯å¾„çº¿
            pathLines.forEach(line => line.remove());
            pathLines = [];
            
            // é‡ç½®ä½ç½®
            char.style.left = startPos.x + 'px';
            char.style.top = startPos.y + 'px';
            currentPos = {...startPos};
            
            // éšè—å®è—
            document.getElementById('treasure').style.display = 'none';
            
            // æ‰§è¡Œæ¯ä¸€æ­¥
            pathData.steps.forEach((step, index) => {
                setTimeout(() => {
                    // ç»˜åˆ¶è·¯å¾„çº¿
                    const line = document.createElement('div');
                    line.className = 'path-line';
                    
                    const startX = currentPos.x + 20;
                    const startY = currentPos.y + 20;
                    
                    if(step.direction === 'north') currentPos.y -= step.distance;
                    if(step.direction === 'south') currentPos.y += step.distance;
                    if(step.direction === 'east') currentPos.x += step.distance;
                    if(step.direction === 'west') currentPos.x -= step.distance;
                    
                    const endX = currentPos.x + 20;
                    const endY = currentPos.y + 20;
                    
                    // è®¡ç®—çº¿æ¡é•¿åº¦å’Œè§’åº¦
                    const dx = endX - startX;
                    const dy = endY - startY;
                    const length = Math.sqrt(dx*dx + dy*dy);
                    const angle = Math.atan2(dy, dx) * 180 / Math.PI;
                    
                    line.style.width = length + 'px';
                    line.style.left = startX + 'px';
                    line.style.top = (startY - 2) + 'px';
                    line.style.transform = `rotate(${angle}deg)`;
                    
                    document.getElementById('map-container').appendChild(line);
                    pathLines.push(line);
                    
                    // ç§»åŠ¨è§’è‰²
                    char.style.left = currentPos.x + 'px';
                    char.style.top = currentPos.y + 'px';
                    
                    // æœ€åä¸€æ­¥æ˜¾ç¤ºå®è—ä½ç½®
                    if(index === pathData.steps.length-1) {
                        setTimeout(() => {
                            document.getElementById('treasure').style.display = 'block';
                            document.getElementById('result').innerHTML = "å·²åˆ°è¾¾ç›®çš„åœ°ï¼è¯·ç‚¹å‡»<button style='background:#e67e22'>ğŸ” æˆ‘åˆ°è¾¾äº†</button>ç¡®è®¤";
                        }, 1500);
                    }
                }, 2000 * (index + 1));
            });
        }
        
        // æ£€æŸ¥ä½ç½®
        function checkPosition() {
            if (!pathData || pathLines.length === 0) {
                document.getElementById('result').innerHTML = "âŒ è¯·å…ˆå®Œæˆè·¯çº¿å¯¼èˆªï¼";
                return;
            }
            
            // è®¡ç®—ä¸å®è—çš„è·ç¦»
            const dx = currentPos.x - treasurePos.x;
            const dy = currentPos.y - treasurePos.y;
            const distance = Math.sqrt(dx*dx + dy*dy);
            
            if(distance < 60) {
                // æˆåŠŸæ•ˆæœ
                document.getElementById('result').innerHTML = 
                    "<div style='color:#27ae60;font-size:24px;'>ğŸ‰ å¯»å®æˆåŠŸï¼</div>" +
                    "<div>æ­å–œæ‰¾åˆ°å®è—ï¼è·å¾—50é‡‘å¸å¥–åŠ±</div>" +
                    "<div style='margin-top:10px'>ğŸ† è§£é”æˆå°±ï¼šåˆçº§æ¢é™©å®¶</div>";
                
                // å®è—å‘å…‰æ•ˆæœ
                const treasure = document.getElementById('treasure');
                treasure.style.boxShadow = "0 0 25px gold";
                treasure.style.transform = "scale(1.2)";
                treasure.style.transition = "all 1s";
            } else {
                // çº é”™æç¤º
                let correction = "";
                if (Math.abs(dy) > 50) {
                    correction += dy > 0 ? `å‘å—${Math.abs(dy)}åƒç´ <br>` : `å‘åŒ—${Math.abs(dy)}åƒç´ <br>`;
                }
                if (Math.abs(dx) > 50) {
                    correction += dx > 0 ? `å‘è¥¿${Math.abs(dx)}åƒç´ <br>` : `å‘ä¸œ${Math.abs(dx)}åƒç´ `;
                }
                
                document.getElementById('result').innerHTML = 
                    "<div style='color:#e74c3c;'>âŒ ä½ç½®é”™è¯¯ï¼å®è—ä¸åœ¨è¿™é‡Œ</div>" +
                    "<div>æ­£ç¡®è·¯çº¿æç¤ºï¼š</div>" +
                    `<div style='background:#fdebd0;padding:10px;border-radius:5px;margin-top:10px;'>${correction}</div>` +
                    "<button onclick='startJourney()' style='margin-top:15px;background:#3498db'>ğŸ”„ é‡æ–°å¯¼èˆª</button>";
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = initMap;
    </script>
</body>
</html>
